"""
utils package for ghast - GitHub Actions Security Tool

This package contains utility functions used throughout ghast.
"""

from .yaml_handler import (
    load_yaml_with_positions,
    load_yaml_file_with_positions,
    clean_positions,
    dump_yaml,
    find_yaml_files,
    find_github_workflow_files,
    is_github_actions_workflow,
    extract_line_from_file,
    get_element_at_path,
)

from .file_handler import (
    is_git_repository,
    find_repository_root,
    has_github_workflows,
    create_file_backup,
    create_timestamped_backup,
    restore_from_backup,
    safe_write_file,
    compute_file_hash,
    files_are_identical,
    list_workflow_files,
    get_modified_workflows,
    ensure_directory_exists,
)

from .version import (
    get_version,
    get_version_info,
    parse_version,
    compare_versions,
    is_version_newer,
    get_latest_action_version,
    parse_github_ref,
    is_sha_pinned,
    is_version_pinned,
    is_unstable_reference,
    __version__,
)

from .formatter import (
    colorize,
    format_severity,
    format_rule_id,
    format_file_path,
    format_line_number,
    format_header,
    format_success,
    format_warning,
    format_error,
    format_info,
    indent,
    format_code_block,
    format_table,
    format_progress,
    format_duration,
    format_count,
    wrap_text,
    print_error,
    print_warning,
    print_success,
    print_info,
    SEVERITY_COLORS,
    SEVERITY_SYMBOLS,
)

__all__ = [
    "load_yaml_with_positions",
    "load_yaml_file_with_positions",
    "clean_positions",
    "dump_yaml",
    "find_yaml_files",
    "find_github_workflow_files",
    "is_github_actions_workflow",
    "extract_line_from_file",
    "get_element_at_path",
    "is_git_repository",
    "find_repository_root",
    "has_github_workflows",
    "create_file_backup",
    "create_timestamped_backup",
    "restore_from_backup",
    "safe_write_file",
    "compute_file_hash",
    "files_are_identical",
    "list_workflow_files",
    "get_modified_workflows",
    "ensure_directory_exists",
    "get_version",
    "get_version_info",
    "parse_version",
    "compare_versions",
    "is_version_newer",
    "get_latest_action_version",
    "parse_github_ref",
    "is_sha_pinned",
    "is_version_pinned",
    "is_unstable_reference",
    "__version__",
    "colorize",
    "format_severity",
    "format_rule_id",
    "format_file_path",
    "format_line_number",
    "format_header",
    "format_success",
    "format_warning",
    "format_error",
    "format_info",
    "indent",
    "format_code_block",
    "format_table",
    "format_progress",
    "format_duration",
    "format_count",
    "wrap_text",
    "print_error",
    "print_warning",
    "print_success",
    "print_info",
    "SEVERITY_COLORS",
    "SEVERITY_SYMBOLS",
]
